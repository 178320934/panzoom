/**
 * @license jquery.panzoom.js v0.0.1
 * Add pan and zoom functionality to an element
 * Uses CSS translation for panning and css transition + scale for zooming
 * <=IE8 NOT supported
 * This plugin depends on Modernizr.touch for detecting touch event support
 * Pinch gestures for zooming is supported where touch is supported
 * Copyright (c) 2012 timmy willison
 * Released under the MIT license
 * https://github.com/jquery/jquery/blob/master/MIT-LICENSE.txt
 */
(function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)})(this,function(t){"use strict";var e=Modernizr&&Modernizr.touch;if(e){var n={props:["touches","pageX","pageY"]};t.each(["touchstart","touchmove","touchend"],function(e,o){t.event.fixHooks[o]=n})}var o=Array.prototype.slice,i="__pz__",s=/([A-Z])/g,a=RegExp("^matrix\\(f,f,f,f,f,f\\)$".replace(/f/g,"([\\d\\.\\-e]+)").replace(/\,/g,"\\,\\s*")),r=function(e,n){var o=this;1!==e.nodeType&&t.error("Panzoom called on non-Element node"),t.contains(document,e)||t.error("Panzoom element must be attached to the document");var a=t.data(e,i);if(a)return a;if(!(this instanceof r))return new r(e,n);n=t.extend({},r.defaults,n),this.options=n,t.style(e,"transform"),this.transform=t.cssProps.transform.replace(s,"-$1").toLowerCase(),this._buildTransition(),this.elem=e;var c=this.$elem=t(e);this.$parent=c.parent();var h=t();return t.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,e){o[e]=n[e]||h}),this._initStyle(),this._bind(),t.data(e,i,this),this};return r.defaults={eventNamespace:".panzoom",transition:!0,increment:.3,minScale:.4,maxScale:5,duration:200,easing:"ease-in-out"},r.prototype={constructor:r,_buildTransition:function(){var t=this.options;this.transform&&(this.transition=this.transform+" "+t.duration+"ms "+t.easing)},_initStyle:function(){this.options,this.$elem.css("cursor","move");var t=this.$parent,e={overflow:"hidden"};"static"===t.css("position")&&(e.position="relative"),t.css(e)},_resetStyle:function(){this.$elem.css({cursor:"",transition:"",transform:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var n=this,o=this.$zoomIn,i=this.$zoomOut,s=this.$zoomRange,a=this.$reset,r=this.options.eventNamespace,c="click"+r,h=(e?"touchstart":"mousedown")+r,u=this.options,m={};m[c]=!1,m[h]=e?function(t){var e=t.touches;e&&(1===e.length?(t.preventDefault(),n._startMove(t.pageX,t.pageY)):2===e.length&&(t.preventDefault(),n._startMove(e)))}:function(t){1===t.which&&null!=t.pageX&&null!=t.pageY&&(t.preventDefault(),n._startMove(t.pageX,t.pageY,t.touches))},this.$elem.on(m),o.length&&i.length&&(o.on(c,function(t){t.preventDefault(),n.zoom()}),i.on(c,function(t){t.preventDefault(),n.zoom(!0)})),s.length&&(s.attr({min:u.minScale,max:u.maxScale,step:.05,value:1}),m={},m[h]=function(){t.style(n.elem,"transition","none")},m["change"+r]=function(){n.zoom(+this.value,!0)},s.on(m)),a.length&&a.on(c,function(t){t.preventDefault(),n.reset()})},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},destroy:function(){this._resetStyle(),this._unbind(),t.removeData(this.elem,i)},_setOptions:function(e){var n=this;t.each(e,function(e,o){switch(e){case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"eventNamespace":n._unbind()}switch(n.options[e]=o,e){case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"eventNamespace":n._bind();break;case"minScale":n.$zoomRange.attr("min",o);break;case"maxScale":n.$zoomRange.attr("max",o);break;case"duration":case"easing":n._buildTransition();break;case"transition":o||t.style(this.elem,"transition","none")}})},option:function(e,n){var o;if(!e)return t.extend({},this.options);if("string"==typeof e){if(1===arguments.length)return this.options[e];o={},o[e]=n}else o=e;this._setOptions(o)},instance:function(){return this},_getMatrix:function(){var e=t.style(this.elem,"transform"),n=a.exec(e);return n&&n.shift(),n||[1,0,0,1,0,0]},_setMatrix:function(e){t.style(this.elem,"transform","matrix("+e.join(",")+")")},zoom:function(e,n){var o=this;this.$elem;var i=this.options,s=this._getMatrix();"number"!=typeof e&&(e=+s[0]+this.options.increment*(e?-1:1),i.transition&&t.style(this.elem,"transition",this.transition)),e>i.maxScale?e=i.maxScale:i.minScale>e&&(e=i.minScale),n||this.$zoomRange.val(e),s[0]=s[3]=e,o._setMatrix(s)},reset:function(){this.options.transition&&t.style(this.elem,"transition",this.transition),t.style(this.elem,"transform","none"),this.$zoomRange.val(1)},_getDistance:function(t){var e=t[0],n=t[1];return Math.sqrt(Math.pow(Math.abs(n.pageX-e.pageX),2)+Math.pow(Math.abs(n.pageY-e.pageY),2))},_startMove:function(n,o){var i,s,a,r,c=this;this.$elem;var h=this.options.eventNamespace,u=t(document).off(h),m=c._getMatrix(),f=m.slice(0);t.style(this.elem,"transition","none"),1===arguments.length?(i=n,s=this._getDistance(i),a=+m[0],r=function(t){t.preventDefault();var e=c._getDistance(t.touches)-s;c.zoom(e/400+a)}):r=function(t){t.preventDefault();var e=t.pageX-n,i=t.pageY-o;m[4]=+f[4]+e,m[5]=+f[5]+i,c._setMatrix(m)},u.on((e?"touchend":"mouseup")+h,function(e){e.preventDefault(),t(this).off(h)}).on((e?"touchmove":"mousemove")+h,r)}},t.fn.panzoom=function(e){var n,s,a,c=[];return"string"==typeof e?(s=o.call(arguments,1),this.each(function(){n=t.data(this,i),n?"_"!==e.charAt(0)&&"function"==typeof(a=n[e])&&void 0!==(a=a.apply(n,s))&&c.push(a):c.push(void 0)}),c.length?1===c.length?c[0]:c:this):this.each(function(){new r(this,e)})},r});